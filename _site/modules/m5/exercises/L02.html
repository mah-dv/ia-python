<!doctype html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    
        <title>Modul 5 - Fil- och felhantering | Introduktion till programmering</title>
    

    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600|Lato|Inconsolata" rel="stylesheet" type="text/css">

    <link href="/assets/css/normalize.css" rel="stylesheet">
	<!--
    <link href="/assets/css/main.css" rel="stylesheet">
	-->
	<link href="http://mah-webb.github.io/assets/css/main.css" rel="stylesheet">
</head>

    <body class="instructions">
        <header id="header" class="header">
<div class="header-inner">
    <a class="brand" href="/" title="Gå till startsidan">Introduktion till programmering</a>

    <ul class="navigation">
        <li>
            <a href="/contact" title="Gå till kontaktsidan">Kontakt</a>
        </li>
    </ul>
</div>
</header>

        <div id="sidebar" class="sidebar">
    <div id="toggle-sidebar" class="toggle-sidebar">...</div>

    <h3 class="course-name">
        <a href="/modules/m5" title="Gå till kursöversikt över ">
            Modul 5 - Fil- och felhantering
        </a>
    </h3>
	
    <ul class="course-overview">
        
        <li>
            <span class="course-overview-element">
                Övningar
                <span class="expand">+</span>
            </span>
            <ul class="course-overview-submenu">
                
                <li>
                    <a href="/modules/m5/exercises/L01.html" title="Gå till laborationen 1. Introduktion till filhantering">
                        1. Introduktion till filhantering
                    </a>
                </li>
                
                <li>
                    <a href="/modules/m5/exercises/L02.html" title="Gå till laborationen 2. Introduktion till felhantering">
                        2. Introduktion till felhantering
                    </a>
                </li>
                
            </ul>
        </li>
        
        
        
        <li>
            <span class="course-overview-element">
                Uppgifter
                <span class="expand">+</span>
            </span>
            <ul class="course-overview-submenu">
                
                <li>
                    <a href="/modules/m5/assignments/U1.html" title="Gå till uppgiften Inlämningsuppgift 4">
                        Inlämningsuppgift 4 
                    </a>
                </li>
                
            </ul>
        </li>
        

        

        
        <li>
            <span class="course-overview-element">
                Föreläsningar
                <span class="expand">+</span>
            </span>
            <ul class="course-overview-submenu">
                
                <li>
                    <a href="/modules/m5/lectures/F01.html" title="Gå till föreläsningen 1. Fil- och felhantering">
                        1. Fil- och felhantering
                    </a>
                </li>
                
            </ul>
        </li>
        
    </ul>
</div>


        <div class="content">
        
            <h1 id="introduktion-till-felhantering">2. Introduktion till felhantering</h1>

<h2 id="inledning">Inledning</h2>

<p>Ibland när man programmerar så blir det inte alltid som man har tänkt sig. Ibland så smyger sig buggar in i programmen man skriver och programmet kraschar (och i IDLE visas en härlig röd text). Detta kan dels bero på programmet behöver förbättras, men kan även bero på externa faktorer. Har ni till exempel i övning 1 (Introduktion till filhantering) försökt att öppna en fil som inte finns? Vad händer då?</p>

<p>Att en fil (som kanske borde finnas?) inte finns kan vara en extern faktor varför ett program kraschar, en annan kan vara felaktig inmatning av användaren. Man kan då bygga förebyggande funktionalitet för att hantera fel som dessa. Detta genom metoden <code>try</code> och <code>except</code>, där man helt enkelt försöker köra något - men skulle det bli fel (t.ex. filen man vill öppna inte finns) så kan man hantera detta fel - utan att programmet kraschar. Smidigt!</p>

<h2 id="att-hantera-fel">Att hantera fel</h2>

<p>Syntaxen i Python för att detta är:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="lineno">1</span> <span class="k">try</span><span class="p">:</span>
<span class="lineno">2</span>     <span class="c"># Koden man vill testa</span>
<span class="lineno">3</span> <span class="k">except</span><span class="p">:</span>
<span class="lineno">4</span>     <span class="c"># Vad som händer om koden misslyckas</span></code></pre></div>

<p>Ett exempel på detta skulle kunna se ut såhär:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="lineno">1</span> <span class="k">try</span><span class="p">:</span>
<span class="lineno">2</span>     <span class="k">print</span> <span class="s">&quot;Tal &quot;</span> <span class="o">+</span> <span class="mi">2</span>
<span class="lineno">3</span> <span class="k">except</span><span class="p">:</span>
<span class="lineno">4</span>     <span class="k">print</span> <span class="s">&quot;Något blev fel!&quot;</span></code></pre></div>

<p>Vi försöker i exemplet ovan att skriva ut <code>"Tal " + 2</code>, vilket ju kommer att generera ett fel - då vi inte kan skriva ut strängar tillsammans med tal. Istället för att programmet kraschar så körs istället <code>print "Något blev fel"</code>.</p>

<p>Man kan i Python fånga olika sorters fel, mer om detta kan ni läsa <a href="https://docs.python.org/2/tutorial/errors.html">här</a>. Det kan ju ibland vara bra att ta reda på vad det är för fel som skapas. En mycket enkel felhantering (för att identifiera felet) skulle kunna se ut såhär:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="lineno">1</span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="lineno">2</span> 
<span class="lineno">3</span> <span class="k">try</span><span class="p">:</span>
<span class="lineno">4</span>     <span class="k">print</span> <span class="s">&quot;Tal &quot;</span> <span class="o">+</span> <span class="mi">2</span>
<span class="lineno">5</span> <span class="k">except</span><span class="p">:</span>
<span class="lineno">6</span>     <span class="k">print</span> <span class="s">&quot;Fel:&quot;</span>
<span class="lineno">7</span>     <span class="k">print</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()</span></code></pre></div>

<p>Detta ser i konsolen, när koden ovan körs, ut såhär:</p>

<p><img src="images/idle6.png" alt="Idle" /></p>

<p>Ovan ser vi att felet var av typen <code>TypeError</code> och beskrivningen av <em>TypeError</em> var <code>cannot concatenate 'str' and 'int' objects</code>.</p>

<h2 id="vningar">Övningar</h2>

<h3 id="vning-1---frbttra-er-bokhanterare">Övning 1 - Förbättra er bokhanterare</h3>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="lineno">1</span> <span class="n">text_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;movies.txt&quot;</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span>
<span class="lineno">2</span> <span class="k">print</span> <span class="n">text_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span></code></pre></div>

<p>Utgå ifrån koden ovan, och skriv en felhanterare <code>try</code>/<code>except</code> för att öppna filen. Om filen <code>movies.txt</code> inte finns ska ett lämpligt felmeddelande visas, annars ska innehållet i filen skrivas ut:</p>

<p>Om filen <em>inte finns</em> ska det se ut såhär:</p>

<p><img src="images/idle7.png" alt="Idle" /></p>

<p>Om fillen <em>finns</em> ska det se ut såhär:</p>

<p><img src="images/idle8.png" alt="Idle" /></p>

<p>Ni kan utgå från <a href="files/movies.txt">denna fil</a> (om ni inte vill skapa en egen).</p>

<h3 id="vning-2---kontrollera-anvndarinput">Övning 2 - Kontrollera användarinput</h3>

<p>Vi ska nu med hjälp av <code>try</code>/<code>except</code> säkerställa att användaren den input som vi eftersöker. Vi ska helt enkelt fråga användaren efter grader i fahrenheit som vi ska konvertera till celcius. Utgå ifrån koden nedan:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="lineno">1</span> <span class="n">fahrenheit</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">&#39;Enter Fahrenheit Temperature:&#39;</span><span class="p">)</span>
<span class="lineno">2</span> <span class="n">fahrenheit</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">fahrenheit</span><span class="p">)</span>
<span class="lineno">3</span> <span class="n">celcius</span> <span class="o">=</span> <span class="p">(</span><span class="n">fahrenheit</span> <span class="o">-</span> <span class="mf">32.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">5.0</span> <span class="o">/</span> <span class="mf">9.0</span>
<span class="lineno">4</span> <span class="k">print</span> <span class="n">celcius</span></code></pre></div>

<p>Kör man koden ovan och vi <em>inte</em> skriver in ett tal (med eller utan decimaler) så kommer programmet att krascha (testa att skriv in <code>hej</code> för att bekräfta detta). Er uppgift är att skriva en felhantering (m.h.a.<code>try</code>/<code>except</code>) för att kontrollera så att användaren matar in siffror/decimaltal. Ni ska dessutom göra en iteration som körs till det att användaren har matat in korrekt information. En exempelkörning kan se ut såhär:</p>

<p><img src="images/idle9.png" alt="Idle" /></p>

        

        <footer class="contribute">
    <p>Har du upptäckt ett fel eller vill bidra med förslag till ändringar? <a href="https://github.com/mah-dv/ia-python" target="_blank" title="Gå till GitHub">Bidra via GitHub</a>!</p>
</footer>

        </div>

        <footer class="footer">
<div class="footer-inner">
    <p class="license">
        Användning av allt material är fritt, om motsatsen inte anges. Formellt utrycks detta med licensen <a href="http://creativecommons.org/licenses/by/2.5/se/" title="Gå till Creative Commons licens sida">Creative Commons Erkännande 2.5 Sverige</a>.
    </p>
    <p class="fork">
        Detta projekt är publicerat som <a href="https://github.com/mah-dv/ia-python" title="Gå till GitHub">öppen källkod på GitHub</a>. Föreslå gärna ändringar och bidra med förbättringar genom att göra en <a href="https://github.com/mah-dv/ia-python" title="Gå till GitHub">fork av detta projekt på GitHub</a>.
    </p>
    <ul class="footer-links">
        <li>
            <a href="/" title="Gå till startsidan">Hem</a>
        </li>
        <li>
            <a href="/contact" title="Gå till kontaktsidan">Kontakt</a>
        </li>
    </ul>
</div>
</footer>
<!--
<script src="/assets/js/common.js"></script>
-->
<script src="/assets/js/common.js"></script>
    </body>
</html>
