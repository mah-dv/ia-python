---
layout: instructions
title: Webbprogrammering
code: web

---

# Dagens exempel och övningar

Idag körde vi praktiska övningar Python. I sann julanda så byggde vi även en önskelista. Se kod nedan:

## Exempel med JSON
{% highlight python linenos %}
import json

'''
Hur ser ett TV-spel ut?

Egenskaper:
- Titel på spel (sträng)
- Betyg (int)
- Beskrivning (sträng)
- Pris (int)
- Åldersgräns (sträng)
- Plattform (lista)

[
    {
        "title": "League of Legends",
        "rating": 7,
        "description": "This is a great game",
        "price": 0,
        "age_limit: "13",
        "platforms": [
            "PC"
        ]
    },
    {
        "title": "Fifa 19",
        "rating": 9,
        "description": "Probably the best football game around",
        "price": 400,
        "age_limit": "3",
        "platforms": [
            "PC",
            "Xbox",
            "Playstation"
        ]
    }
]
'''


try:
    my_file = open("games.json", "r")
    games = json.loads(my_file.read())
    my_file.close()
except:
    my_file = open("games.json", "w")
    games = []
    my_file.write(json.dumps(games))
    my_file.close()

print("Spel i min samling")
print("******************")
for index, game in enumerate(games):
    print("Spel nr.{}".format(index+1))
    print("{:<15}: {}".format("Titel", game["title"]))
    print("{:<15}: {}".format("Betyg", game["rating"]))
    print("{:<15}: {}".format("Beskrivning", game["description"]))
    print("{:<15}: {}".format("Pris", game["price"]))
    print("{:<15}: {}".format("Åldersgräns", game["age_limit"]))
    print("Platformar:")
    for platform in game["platforms"]:
        print("- {}".format(platform))
    print("")

print("Lägg till ett spel")
print("******************")
game = {}
game["title"] = input("Titel: ")
game["rating"] = int(input("Betyg: "))
game["description"] = input("Beskrivning: ")
game["price"] = int(input("Pris: "))
game["age_limit"] = input("Åldersgräns: ")
game["platforms"] = []
while input("Vill du lägga till en (ny) platform? ").lower() == "ja":
    game["platforms"].append(input("Platform: "))

games.append(game)

my_file = open("games.json", "w")
my_file.write(json.dumps(games, indent=4))
my_file.close()



'''
a = [1, 2, 3]
print(a)
a.append(4)
print(a)
print(type(a))

a_as_text = json.dumps(a)
print(a_as_text)
print(type(a_as_text))

a_as_list = json.loads(a_as_text)
print(a_as_list)
print(type(a_as_list))
'''
{% endhighlight %}

## Önskelista

Ni kan antingen ladda ner all kod [här](/modules/web/lectures/bottle_ex.zip), eller se den nedan:

## bottle_app.py

{% highlight python linenos %}
from bottle import run, route, static_file, template, request
import json

def get_wishes():
    try:
        my_file = open("wishes.json", "r")
        wishes = json.loads(my_file.read())
        my_file.close()

        return wishes
    except:
        my_file = open("wishes.json", "w")
        wishes = []
        my_file.write(json.dumps(wishes))
        my_file.close()

        return wishes

@route("/")
def index():
    return template("index", wishes=get_wishes())

@route("/new", method="POST")
def add_new_wish():
    wish = {}
    wish["title"] = getattr(request.forms, "title")
    wish["link"] = getattr(request.forms, "link")
    wish["prio"] = getattr(request.forms, "prio")

    wishes = get_wishes()
    wishes.append(wish)

    my_file = open("wishes.json", "w")
    my_file.write(json.dumps(wishes, indent=4))
    my_file.close()
    
    return template("index", wishes=get_wishes())

@route("/static/<filename>")
def static_files(filename):
    return static_file(filename, root="static")

run(host="localhost", port=8000)
{% endhighlight %}

## index.html
{% highlight html linenos %}
<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Min önskelista</title>
		<link href="https://fonts.googleapis.com/css?family=Mountains+of+Christmas" rel="stylesheet">
		<link href="/static/style.css" rel="stylesheet">
	</head>
	<body>
		<header>
			<h1>Min önskelista</h1>
		</header>
		
		<main id="wish-box">
			<img src="/static/santa.png" alt="Santa" id="santa">
			<img src="/static/hat.png" alt="Hat" id="hat">

			<h2>Mina önskningar</h2>
			<ul id="wishes">
			% for wish in wishes:
				<li class="prio-{{ wish['prio'] }}">
					<a href="{{ wish['link'] }}">{{ wish["title"] }}</a>
				</li>
			% end
			</ul>
			
			<h2 id="show-form">Lägg till en önskning</h2>
			<form action="/new" method="post">
				<label for="title">Vad önskar du dig?</label>
				<input type="text" id="title" name="title">
				<label for="link">Länk till saken:</label>
				<input type="text" id="link" name="link">
				<label for="prio">Hur mycket önskar du dig detta?</label>
				<select name="prio">
					<option value="1">Lite</option>
					<option value="2">Mellan</option>
					<option value="3">Mycket</option>
					<option value="4">Jättemycket</option>
				</select>
				<hr>
				<input type="submit" value="Spara önskning">
			</form>
		</main>
	
		<script src="/static/jquery-3.1.1.min.js"></script>
		<script src="/static/snowfall.jquery.js"></script>
		<script src="/static/script.js"></script>
	</body>
</html>
{% endhighlight %}

## style.css
{% highlight css linenos %}
body {
	background-image: url("/static/background.jpg");
	background-repeat: no-repeat;
	background-position: center top;
	background-size: 100%;
	margin: 0px;
	font-family: 'Mountains of Christmas', cursive;
}

body > header > h1 {
	background-color: rgba(0, 0, 0, 0.7);
	color: white;
	margin: 0px;
	padding: 20px;
	text-align: center;
	box-shadow: 0px 0px 10px #000;
}

#wish-box {
	width: 500px;
	margin: 120px auto 0 auto;
	background-color: rgba(255, 255, 255, 0.8);
	border-radius: 10px;
	box-shadow: 0px 0px 10px #000;
	overflow: hidden;
}

#wish-box h2 {
	background-color: black;
	color: white;
	text-align: center;
	margin: 0px;
	padding: 5px;
}

#wish-box label, #wish-box input, #wish-box select {
	width: 100%;
	display: block;
}

#wishes {
	padding: 0px;
	margin: 0px;
}

#wishes li {
	list-style-type: none;
}

#wishes li a{
	display: block;
	color: #eee;
	box-shadow: 0 0 2px #333;
	padding: 10px;
	margin: 5px 20px;
	color: #000;
	text-decoration: none;
}

#wish-box form {
	padding: 10px;
	display: none;
}

.prio-1 > a {
	background-color: #fff;
}

.prio-2 > a {
	background-color: #ddd;
}

.prio-3 > a {
	background-color: #bbb;
}

.prio-4 > a {
	background-color: #999;
}

#santa{
	position: absolute;
	width: 150px;
	margin-top:-126px;
	margin-left: 350px;
}

#hat{
	position: absolute;
	width: 150px;
	margin-top: -60px;
	margin-left: -70px;
	z-index: 999999999999;
}
{% endhighlight %}

## wish-list.txt
{% highlight text linenos %}
[
    {
        "title": "iPhone X",
        "link": "https://www.prisjakt.nu/produkt.php?p=4471962",
        "prio": "2"
    }
]
{% endhighlight %}
